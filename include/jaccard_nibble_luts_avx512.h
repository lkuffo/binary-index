/////////////////////////////////
/////////////////////////////////
/// Intersection and Union    ///
/// LUTs for nibbles [AVX512] ///
/////////////////////////////////
/////////////////////////////////
/*
x = range(0, 16)
y = range(15, -1, -1)
for i in x:
     print(f"alignas(64) static const __m512i m512_xor_lut_{i} = _mm512_set_epi8(")
     print("\t", end = "")
     for j in y:
         print(bin(i ^ j).count("1"), end=", ")
     print("\n\t", end = "")
     for j in y:
         print(bin(i ^ j).count("1"), end=", ")
     print("\n\t", end = "")
     for j in y:
         print(bin(i ^ j).count("1"), end=", ")
     print("\n\t", end = "")
     for j in y:
         print(bin(i ^ j).count("1"), end=", ")
     print()
     print(");")
     print()
*/

alignas(64) static const __m512i m512_intersection_lut_0  = _mm512_set_epi8(
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
);

alignas(64) static const __m512i m512_intersection_lut_1  = _mm512_set_epi8(
    1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,
    1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,
    1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,
    1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
);

alignas(64) static const __m512i m512_intersection_lut_2  = _mm512_set_epi8(
    1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,
    1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,
    1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,
    1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0
);

alignas(64) static const __m512i m512_intersection_lut_3  = _mm512_set_epi8(
    2,1,1,0,2,1,1,0,2,1,1,0,2,1,1,0,
    2,1,1,0,2,1,1,0,2,1,1,0,2,1,1,0,
    2,1,1,0,2,1,1,0,2,1,1,0,2,1,1,0,
    2,1,1,0,2,1,1,0,2,1,1,0,2,1,1,0
);

alignas(64) static const __m512i m512_intersection_lut_4  = _mm512_set_epi8(
    1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,
    1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,
    1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,
    1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0
);

alignas(64) static const __m512i m512_intersection_lut_5  = _mm512_set_epi8(
    2,1,2,1,2,1,0,1,2,1,2,1,0,1,0,1,
    2,1,2,1,2,1,0,1,2,1,2,1,0,1,0,1,
    2,1,2,1,2,1,0,1,2,1,2,1,0,1,0,1,
    2,1,2,1,2,1,0,1,2,1,2,1,0,1,0,1
);

alignas(64) static const __m512i m512_intersection_lut_6  = _mm512_set_epi8(
    2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,
    2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,
    2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1,
    2,2,1,1,2,2,1,1,2,2,1,1,2,2,1,1
);

alignas(64) static const __m512i m512_intersection_lut_7  = _mm512_set_epi8(
    3,2,2,1,3,2,2,1,3,2,2,1,3,2,2,1,
    3,2,2,1,3,2,2,1,3,2,2,1,3,2,2,1,
    3,2,2,1,3,2,2,1,3,2,2,1,3,2,2,1,
    3,2,2,1,3,2,2,1,3,2,2,1,3,2,2,1
);

alignas(64) static const __m512i m512_intersection_lut_8  = _mm512_set_epi8(
    1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,
    1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,
    1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,
    1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0
);

alignas(64) static const __m512i m512_intersection_lut_9  = _mm512_set_epi8(
    2,1,2,1,2,1,2,1,1,0,1,0,1,0,1,0,
    2,1,2,1,2,1,2,1,1,0,1,0,1,0,1,0,
    2,1,2,1,2,1,2,1,1,0,1,0,1,0,1,0,
    2,1,2,1,2,1,2,1,1,0,1,0,1,0,1,0
);

alignas(64) static const __m512i m512_intersection_lut_10 = _mm512_set_epi8(
    2,2,1,1,2,2,1,1,1,1,0,0,1,1,0,0,
    2,2,1,1,2,2,1,1,1,1,0,0,1,1,0,0,
    2,2,1,1,2,2,1,1,1,1,0,0,1,1,0,0,
    2,2,1,1,2,2,1,1,1,1,0,0,1,1,0,0
);

alignas(64) static const __m512i m512_intersection_lut_11 = _mm512_set_epi8(
    3,2,2,1,3,2,2,1,2,1,1,0,3,2,2,1,
    3,2,2,1,3,2,2,1,2,1,1,0,3,2,2,1,
    3,2,2,1,3,2,2,1,2,1,1,0,3,2,2,1,
    3,2,2,1,3,2,2,1,2,1,1,0,3,2,2,1
);

alignas(64) static const __m512i m512_intersection_lut_12 = _mm512_set_epi8(
    2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,
    2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,
    2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,
    2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0
);

alignas(64) static const __m512i m512_intersection_lut_13 = _mm512_set_epi8(
    3,2,3,2,2,1,2,1,2,1,2,1,0,1,0,1,
    3,2,3,2,2,1,2,1,2,1,2,1,0,1,0,1,
    3,2,3,2,2,1,2,1,2,1,2,1,0,1,0,1,
    3,2,3,2,2,1,2,1,2,1,2,1,0,1,0,1
);

alignas(64) static const __m512i m512_intersection_lut_14 = _mm512_set_epi8(
    3,3,2,2,2,2,1,1,2,2,1,1,1,1,0,0,
    3,3,2,2,2,2,1,1,2,2,1,1,1,1,0,0,
    3,3,2,2,2,2,1,1,2,2,1,1,1,1,0,0,
    3,3,2,2,2,2,1,1,2,2,1,1,1,1,0,0
);

alignas(64) static const __m512i m512_intersection_lut_15 = _mm512_set_epi8(
    4,3,3,2,3,2,2,1,3,2,2,1,1,2,1,0,
    4,3,3,2,3,2,2,1,3,2,2,1,1,2,1,0,
    4,3,3,2,3,2,2,1,3,2,2,1,1,2,1,0,
    4,3,3,2,3,2,2,1,3,2,2,1,1,2,1,0
);


alignas(64) static const __m512i m512_union_lut_0  = _mm512_set_epi8(
    4, 3, 3, 2, 3, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 0,
    4, 3, 3, 2, 3, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 0,
    4, 3, 3, 2, 3, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 0,
    4, 3, 3, 2, 3, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 0
);

alignas(64) static const __m512i m512_union_lut_1  = _mm512_set_epi8(
    4, 4, 3, 3, 3, 3, 2, 2, 3, 3, 2, 2, 3, 3, 2, 2,
    4, 4, 3, 3, 3, 3, 2, 2, 3, 3, 2, 2, 3, 3, 2, 2,
    4, 4, 3, 3, 3, 3, 2, 2, 3, 3, 2, 2, 3, 3, 2, 2,
    4, 4, 3, 3, 3, 3, 2, 2, 3, 3, 2, 2, 3, 3, 2, 2
);

alignas(64) static const __m512i m512_union_lut_2  = _mm512_set_epi8(
    4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2, 3, 2, 2, 1,
    4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2, 3, 2, 2, 1,
    4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2, 3, 2, 2, 1,
    4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2, 3, 2, 2, 1
);

alignas(64) static const __m512i m512_union_lut_3  = _mm512_set_epi8(
    4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3,
    4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3,
    4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3,
    4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3
);

alignas(64) static const __m512i m512_union_lut_4  = _mm512_set_epi8(
    4, 3, 3, 2, 4, 3, 3, 2, 3, 3, 2, 1, 3, 2, 2, 1,
    4, 3, 3, 2, 4, 3, 3, 2, 3, 3, 2, 1, 3, 2, 2, 1,
    4, 3, 3, 2, 4, 3, 3, 2, 3, 3, 2, 1, 3, 2, 2, 1,
    4, 3, 3, 2, 4, 3, 3, 2, 3, 3, 2, 1, 3, 2, 2, 1
);

alignas(64) static const __m512i m512_union_lut_5  = _mm512_set_epi8(
    4, 4, 3, 3, 4, 4, 3, 3, 4, 3, 3, 2, 3, 3, 2, 2,
    4, 4, 3, 3, 4, 4, 3, 3, 4, 3, 3, 2, 3, 3, 2, 2,
    4, 4, 3, 3, 4, 4, 3, 3, 4, 3, 3, 2, 3, 3, 2, 2,
    4, 4, 3, 3, 4, 4, 3, 3, 4, 3, 3, 2, 3, 3, 2, 2
);

alignas(64) static const __m512i m512_union_lut_6  = _mm512_set_epi8(
    4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2,
    4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2,
    4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2,
    4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2
);

alignas(64) static const __m512i m512_union_lut_7  = _mm512_set_epi8(
    4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3,
    4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3,
    4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3,
    4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3
);

alignas(64) static const __m512i m512_union_lut_8  = _mm512_set_epi8(
    4, 3, 3, 2, 1, 4, 3, 3, 2, 2, 1, 1, 4, 3, 3, 2,
    4, 3, 3, 2, 1, 4, 3, 3, 2, 2, 1, 1, 4, 3, 3, 2,
    4, 3, 3, 2, 1, 4, 3, 3, 2, 2, 1, 1, 4, 3, 3, 2,
    4, 3, 3, 2, 1, 4, 3, 3, 2, 2, 1, 1, 4, 3, 3, 2
);

alignas(64) static const __m512i m512_union_lut_9  = _mm512_set_epi8(
    4, 4, 3, 3, 3, 3, 2, 2, 4, 4, 3, 3, 3, 3, 2, 2,
    4, 4, 3, 3, 3, 3, 2, 2, 4, 4, 3, 3, 3, 3, 2, 2,
    4, 4, 3, 3, 3, 3, 2, 2, 4, 4, 3, 3, 3, 3, 2, 2,
    4, 4, 3, 3, 3, 3, 2, 2, 4, 4, 3, 3, 3, 3, 2, 2
);

alignas(64) static const __m512i m512_union_lut_10 = _mm512_set_epi8(
    4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2,
    4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2,
    4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2,
    4, 3, 4, 3, 4, 3, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2
);

alignas(64) static const __m512i m512_union_lut_11 = _mm512_set_epi8(
    4, 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3,
    4, 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3,
    4, 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3,
    4, 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3
);

alignas(64) static const __m512i m512_union_lut_12 = _mm512_set_epi8(
    4, 3, 3, 2, 4, 3, 3, 2, 4, 3, 3, 2, 4, 3, 3, 2,
    4, 3, 3, 2, 4, 3, 3, 2, 4, 3, 3, 2, 4, 3, 3, 2,
    4, 3, 3, 2, 4, 3, 3, 2, 4, 3, 3, 2, 4, 3, 3, 2,
    4, 3, 3, 2, 4, 3, 3, 2, 4, 3, 3, 2, 4, 3, 3, 2
);

alignas(64) static const __m512i m512_union_lut_13 = _mm512_set_epi8(
    4, 4, 3, 3, 4, 4, 3, 3, 4, 4, 3, 3, 4, 4, 3, 3,
    4, 4, 3, 3, 4, 4, 3, 3, 4, 4, 3, 3, 4, 4, 3, 3,
    4, 4, 3, 3, 4, 4, 3, 3, 4, 4, 3, 3, 4, 4, 3, 3,
    4, 4, 3, 3, 4, 4, 3, 3, 4, 4, 3, 3, 4, 4, 3, 3
);

alignas(64) static const __m512i m512_union_lut_14 = _mm512_set_epi8(
    4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3,
    4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3,
    4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3,
    4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3
);

alignas(64) static const __m512i m512_union_lut_15 = _mm512_set_epi8(
    4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
    4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
    4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
    4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4
);

alignas(64) static const __m512i m512_xor_lut_0 = _mm512_set_epi8(
	4, 3, 3, 2, 3, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 0,
	4, 3, 3, 2, 3, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 0,
	4, 3, 3, 2, 3, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 0,
	4, 3, 3, 2, 3, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 0
);

alignas(64) static const __m512i m512_xor_lut_1 = _mm512_set_epi8(
	3, 4, 2, 3, 2, 3, 1, 2, 2, 3, 1, 2, 1, 2, 0, 1,
	3, 4, 2, 3, 2, 3, 1, 2, 2, 3, 1, 2, 1, 2, 0, 1,
	3, 4, 2, 3, 2, 3, 1, 2, 2, 3, 1, 2, 1, 2, 0, 1,
	3, 4, 2, 3, 2, 3, 1, 2, 2, 3, 1, 2, 1, 2, 0, 1
);

alignas(64) static const __m512i m512_xor_lut_2 = _mm512_set_epi8(
	3, 2, 4, 3, 2, 1, 3, 2, 2, 1, 3, 2, 1, 0, 2, 1,
	3, 2, 4, 3, 2, 1, 3, 2, 2, 1, 3, 2, 1, 0, 2, 1,
	3, 2, 4, 3, 2, 1, 3, 2, 2, 1, 3, 2, 1, 0, 2, 1,
	3, 2, 4, 3, 2, 1, 3, 2, 2, 1, 3, 2, 1, 0, 2, 1
);

alignas(64) static const __m512i m512_xor_lut_3 = _mm512_set_epi8(
	2, 3, 3, 4, 1, 2, 2, 3, 1, 2, 2, 3, 0, 1, 1, 2,
	2, 3, 3, 4, 1, 2, 2, 3, 1, 2, 2, 3, 0, 1, 1, 2,
	2, 3, 3, 4, 1, 2, 2, 3, 1, 2, 2, 3, 0, 1, 1, 2,
	2, 3, 3, 4, 1, 2, 2, 3, 1, 2, 2, 3, 0, 1, 1, 2
);

alignas(64) static const __m512i m512_xor_lut_4 = _mm512_set_epi8(
	3, 2, 2, 1, 4, 3, 3, 2, 2, 1, 1, 0, 3, 2, 2, 1,
	3, 2, 2, 1, 4, 3, 3, 2, 2, 1, 1, 0, 3, 2, 2, 1,
	3, 2, 2, 1, 4, 3, 3, 2, 2, 1, 1, 0, 3, 2, 2, 1,
	3, 2, 2, 1, 4, 3, 3, 2, 2, 1, 1, 0, 3, 2, 2, 1
);

alignas(64) static const __m512i m512_xor_lut_5 = _mm512_set_epi8(
	2, 3, 1, 2, 3, 4, 2, 3, 1, 2, 0, 1, 2, 3, 1, 2,
	2, 3, 1, 2, 3, 4, 2, 3, 1, 2, 0, 1, 2, 3, 1, 2,
	2, 3, 1, 2, 3, 4, 2, 3, 1, 2, 0, 1, 2, 3, 1, 2,
	2, 3, 1, 2, 3, 4, 2, 3, 1, 2, 0, 1, 2, 3, 1, 2
);

alignas(64) static const __m512i m512_xor_lut_6 = _mm512_set_epi8(
	2, 1, 3, 2, 3, 2, 4, 3, 1, 0, 2, 1, 2, 1, 3, 2,
	2, 1, 3, 2, 3, 2, 4, 3, 1, 0, 2, 1, 2, 1, 3, 2,
	2, 1, 3, 2, 3, 2, 4, 3, 1, 0, 2, 1, 2, 1, 3, 2,
	2, 1, 3, 2, 3, 2, 4, 3, 1, 0, 2, 1, 2, 1, 3, 2
);

alignas(64) static const __m512i m512_xor_lut_7 = _mm512_set_epi8(
	1, 2, 2, 3, 2, 3, 3, 4, 0, 1, 1, 2, 1, 2, 2, 3,
	1, 2, 2, 3, 2, 3, 3, 4, 0, 1, 1, 2, 1, 2, 2, 3,
	1, 2, 2, 3, 2, 3, 3, 4, 0, 1, 1, 2, 1, 2, 2, 3,
	1, 2, 2, 3, 2, 3, 3, 4, 0, 1, 1, 2, 1, 2, 2, 3
);

alignas(64) static const __m512i m512_xor_lut_8 = _mm512_set_epi8(
	3, 2, 2, 1, 2, 1, 1, 0, 4, 3, 3, 2, 3, 2, 2, 1,
	3, 2, 2, 1, 2, 1, 1, 0, 4, 3, 3, 2, 3, 2, 2, 1,
	3, 2, 2, 1, 2, 1, 1, 0, 4, 3, 3, 2, 3, 2, 2, 1,
	3, 2, 2, 1, 2, 1, 1, 0, 4, 3, 3, 2, 3, 2, 2, 1
);

alignas(64) static const __m512i m512_xor_lut_9 = _mm512_set_epi8(
	2, 3, 1, 2, 1, 2, 0, 1, 3, 4, 2, 3, 2, 3, 1, 2,
	2, 3, 1, 2, 1, 2, 0, 1, 3, 4, 2, 3, 2, 3, 1, 2,
	2, 3, 1, 2, 1, 2, 0, 1, 3, 4, 2, 3, 2, 3, 1, 2,
	2, 3, 1, 2, 1, 2, 0, 1, 3, 4, 2, 3, 2, 3, 1, 2
);

alignas(64) static const __m512i m512_xor_lut_10 = _mm512_set_epi8(
	2, 1, 3, 2, 1, 0, 2, 1, 3, 2, 4, 3, 2, 1, 3, 2,
	2, 1, 3, 2, 1, 0, 2, 1, 3, 2, 4, 3, 2, 1, 3, 2,
	2, 1, 3, 2, 1, 0, 2, 1, 3, 2, 4, 3, 2, 1, 3, 2,
	2, 1, 3, 2, 1, 0, 2, 1, 3, 2, 4, 3, 2, 1, 3, 2
);

alignas(64) static const __m512i m512_xor_lut_11 = _mm512_set_epi8(
	1, 2, 2, 3, 0, 1, 1, 2, 2, 3, 3, 4, 1, 2, 2, 3,
	1, 2, 2, 3, 0, 1, 1, 2, 2, 3, 3, 4, 1, 2, 2, 3,
	1, 2, 2, 3, 0, 1, 1, 2, 2, 3, 3, 4, 1, 2, 2, 3,
	1, 2, 2, 3, 0, 1, 1, 2, 2, 3, 3, 4, 1, 2, 2, 3
);

alignas(64) static const __m512i m512_xor_lut_12 = _mm512_set_epi8(
	2, 1, 1, 0, 3, 2, 2, 1, 3, 2, 2, 1, 4, 3, 3, 2,
	2, 1, 1, 0, 3, 2, 2, 1, 3, 2, 2, 1, 4, 3, 3, 2,
	2, 1, 1, 0, 3, 2, 2, 1, 3, 2, 2, 1, 4, 3, 3, 2,
	2, 1, 1, 0, 3, 2, 2, 1, 3, 2, 2, 1, 4, 3, 3, 2
);

alignas(64) static const __m512i m512_xor_lut_13 = _mm512_set_epi8(
	1, 2, 0, 1, 2, 3, 1, 2, 2, 3, 1, 2, 3, 4, 2, 3,
	1, 2, 0, 1, 2, 3, 1, 2, 2, 3, 1, 2, 3, 4, 2, 3,
	1, 2, 0, 1, 2, 3, 1, 2, 2, 3, 1, 2, 3, 4, 2, 3,
	1, 2, 0, 1, 2, 3, 1, 2, 2, 3, 1, 2, 3, 4, 2, 3
);

alignas(64) static const __m512i m512_xor_lut_14 = _mm512_set_epi8(
	1, 0, 2, 1, 2, 1, 3, 2, 2, 1, 3, 2, 3, 2, 4, 3,
	1, 0, 2, 1, 2, 1, 3, 2, 2, 1, 3, 2, 3, 2, 4, 3,
	1, 0, 2, 1, 2, 1, 3, 2, 2, 1, 3, 2, 3, 2, 4, 3,
	1, 0, 2, 1, 2, 1, 3, 2, 2, 1, 3, 2, 3, 2, 4, 3
);

alignas(64) static const __m512i m512_xor_lut_15 = _mm512_set_epi8(
	0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,
	0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,
	0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,
	0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4
);

// The 15 XOR lookup tables can be represented with only 1 lookup table and
// 6 ADD transformations as seen here
/*
4, 3, 3, 2, 3, 2, 2, 1, 3, 2, 2, 1, 2, 1, 1, 0,  [base LUT]
3, 4, 2, 3, 2, 3, 1, 2, 2, 3, 1, 2, 1, 2, 0, 1,  [-1, +1, -1, +1, ...] transf1
3, 2, 4, 3, 2, 1, 3, 2, 2, 1, 3, 2, 1, 0, 2, 1,  [-1, -1, +1, +1, ...] transf2
2, 3, 3, 4, 1, 2, 2, 3, 1, 2, 2, 3, 0, 1, 1, 2,  [-2,  0,  0, +2, ...] transf3
3, 2, 2, 1, 4, 3, 3, 2, 2, 1, 1, 0, 3, 2, 2, 1,  [-1, -1, -1, -1, +1, +1, +1, +1, -1, -1, -1, -1, +1, +1, +1, +1] lookup1
2, 3, 1, 2, 3, 4, 2, 3, 1, 2, 0, 1, 2, 3, 1, 2,  [-1, +1, -1, +1, ...]
2, 1, 3, 2, 3, 2, 4, 3, 1, 0, 2, 1, 2, 1, 3, 2,  [-1, -1, +1, +1, ...]
1, 2, 2, 3, 2, 3, 3, 4, 0, 1, 1, 2, 1, 2, 2, 3,  [-2,  0,  0, +2, ...]
3, 2, 2, 1, 2, 1, 1, 0, 4, 3, 3, 2, 3, 2, 2, 1,  [-1, -1, -1, -1, -1, -1, -1, -1, +1, +1, +1, +1, +1, +1, +1, +1] lookup2
2, 3, 1, 2, 1, 2, 0, 1, 3, 4, 2, 3, 2, 3, 1, 2,  [-1, +1]
2, 1, 3, 2, 1, 0, 2, 1, 3, 2, 4, 3, 2, 1, 3, 2,  [-1, -1, +1, +1]
1, 2, 2, 3, 0, 1, 1, 2, 2, 3, 3, 4, 1, 2, 2, 3,  [-2,  0,  0, +2, ...]
2, 1, 1, 0, 3, 2, 2, 1, 3, 2, 2, 1, 4, 3, 3, 2,  [-2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0, +2, +2, +2, +2] lookup3
1, 2, 0, 1, 2, 3, 1, 2, 2, 3, 1, 2, 3, 4, 2, 3,  [-1, +1]
1, 0, 2, 1, 2, 1, 3, 2, 2, 1, 3, 2, 3, 2, 4, 3,  [-1, -1, +1, +1]
0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,  [-2,  0,  0, +2, ...]

Another option is to store the first 7 LUTs, the next 7 are calculated as: 4 - LUT
E.g.
LUT8 = 4 - LUT7
LUT9 = 4 - LUT6
LUT10 = 4 - LUT5
LUT11 = 4 - LUT4
LUT12 = 4 - LUT3
LUT13 = 4 - LUT2
LUT14 = 4 - LUT1
LUT15 = 4 - LUT0

If we only store LUT0, LUT1, LUT3 and LUT4, we can generate 3, 5 and 6 from:
row(3)=row(1)+row(2)−row(0)
row(5)=row(1)+row(4)−row(0)
row(6)=row(2)+row(4)−row(0)
And then the others with the (4-LUT) formula

*/
__m512i lookup1 = _mm512_set_epi8(
    -1, -1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 1, 1, 1,
    -1, -1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 1, 1, 1,
    -1, -1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 1, 1, 1,
    -1, -1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 1, 1, 1
);
__m512i lookup2 = _mm512_set_epi8(
    -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, 1, 1,
    -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, 1, 1,
    -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, 1, 1,
    -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1, 1, 1, 1, 1
);
__m512i lookup3 = _mm512_set_epi8(
    -2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0, 2, 2, 2, 2,
    -2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0, 2, 2, 2, 2,
    -2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0, 2, 2, 2, 2,
    -2, -2, -2, -2,  0,  0,  0,  0,  0,  0,  0,  0, 2, 2, 2, 2
);
__m512i transf1 = _mm512_set_epi8(
    -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1,
    -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1,
    -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1,
    -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1
);
__m512i transf2 = _mm512_set_epi8(
    -1, -1, +1, +1, -1, -1, +1, +1, -1, -1, +1, +1, -1, -1, +1, +1,
    -1, -1, +1, +1, -1, -1, +1, +1, -1, -1, +1, +1, -1, -1, +1, +1,
    -1, -1, +1, +1, -1, -1, +1, +1, -1, -1, +1, +1, -1, -1, +1, +1,
    -1, -1, +1, +1, -1, -1, +1, +1, -1, -1, +1, +1, -1, -1, +1, +1
);
__m512i transf3 = _mm512_set_epi8(
    -2,  0,  0, +2, -2,  0,  0, +2, -2,  0,  0, +2, -2,  0,  0, +2,
    -2,  0,  0, +2, -2,  0,  0, +2, -2,  0,  0, +2, -2,  0,  0, +2,
    -2,  0,  0, +2, -2,  0,  0, +2, -2,  0,  0, +2, -2,  0,  0, +2,
    -2,  0,  0, +2, -2,  0,  0, +2, -2,  0,  0, +2, -2,  0,  0, +2
);

__m512i m512_base_lut = _mm512_set_epi8(
    1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, // Nibble: 1
    1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, // 2
    1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, // 4
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0  // 8
);


alignas(64) static const __m512i m512_intersection_lookup_tables[16] = {
    m512_intersection_lut_0, m512_intersection_lut_1, m512_intersection_lut_2, m512_intersection_lut_3,
    m512_intersection_lut_4, m512_intersection_lut_5, m512_intersection_lut_6, m512_intersection_lut_7,
    m512_intersection_lut_8, m512_intersection_lut_9, m512_intersection_lut_10, m512_intersection_lut_11,
    m512_intersection_lut_12, m512_intersection_lut_13, m512_intersection_lut_14, m512_intersection_lut_15
};

alignas(64) static const __m512i m512_union_lookup_tables[16] = {
    m512_union_lut_0, m512_union_lut_1, m512_union_lut_2, m512_union_lut_3,
    m512_union_lut_4, m512_union_lut_5, m512_union_lut_6, m512_union_lut_7,
    m512_union_lut_8, m512_union_lut_9, m512_union_lut_10, m512_union_lut_11,
    m512_union_lut_12, m512_union_lut_13, m512_union_lut_14, m512_union_lut_15
};

alignas(64) static const __m512i m512_xor_lookup_tables[16] = {
    m512_xor_lut_0, m512_xor_lut_1, m512_xor_lut_2, m512_xor_lut_3,
    m512_xor_lut_4, m512_xor_lut_5, m512_xor_lut_6, m512_xor_lut_7,
    m512_xor_lut_8, m512_xor_lut_9, m512_xor_lut_10, m512_xor_lut_11,
    m512_xor_lut_12, m512_xor_lut_13, m512_xor_lut_14, m512_xor_lut_15
};